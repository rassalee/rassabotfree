const a0_0x2ba2e2=a0_0x49be;(function(_0x5320a6,_0x52cc82){const _0x27639e=a0_0x49be,_0x163bad=_0x5320a6();while(!![]){try{const _0x571744=parseInt(_0x27639e(0x116))/0x1*(-parseInt(_0x27639e(0x102))/0x2)+parseInt(_0x27639e(0xc3))/0x3+parseInt(_0x27639e(0xe7))/0x4*(-parseInt(_0x27639e(0x100))/0x5)+-parseInt(_0x27639e(0x107))/0x6+-parseInt(_0x27639e(0xc1))/0x7+-parseInt(_0x27639e(0xf0))/0x8+parseInt(_0x27639e(0x113))/0x9;if(_0x571744===_0x52cc82)break;else _0x163bad['push'](_0x163bad['shift']());}catch(_0x40e74a){_0x163bad['push'](_0x163bad['shift']());}}}(a0_0x4c42,0x46b9f));function a0_0x49be(_0x445b8b,_0x2da507){const _0x48dbd1=a0_0x4c42();return a0_0x49be=function(_0x9c60c0,_0x3c6c01){_0x9c60c0=_0x9c60c0-0xb9;let _0x4c42ef=_0x48dbd1[_0x9c60c0];return _0x4c42ef;},a0_0x49be(_0x445b8b,_0x2da507);}const a0_0x3c6c01=(function(){let _0x32e344=!![];return function(_0x2de144,_0x26501a){const _0x39f1ab=_0x32e344?function(){const _0xc91c9e=a0_0x49be;if(_0x26501a){const _0x8cb20=_0x26501a[_0xc91c9e(0xcd)](_0x2de144,arguments);return _0x26501a=null,_0x8cb20;}}:function(){};return _0x32e344=![],_0x39f1ab;};}()),a0_0x9c60c0=a0_0x3c6c01(this,function(){const _0x51e531=a0_0x49be;return a0_0x9c60c0[_0x51e531(0xf5)]()[_0x51e531(0xf8)]('(((.+)+)+)+$')['toString']()[_0x51e531(0xc6)](a0_0x9c60c0)[_0x51e531(0xf8)](_0x51e531(0xdc));});a0_0x9c60c0();import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x14b9d0 from'fs';import*as a0_0x39eb6c from'path';import*as a0_0x57c68c from'crypto';import{ffmpeg}from'./converter.js';import a0_0x37da7a from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x292f37 from'./uploadFile.js';import a0_0x5963ab from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x554b94 from'node-webpmux';import a0_0x11eb8b from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x39eb6c['join'](__dirname,a0_0x2ba2e2(0x112));function sticker2(_0x250382,_0x1d7ed3){const _0x224fd5=a0_0x2ba2e2,_0x2ffbe5={'OcbDl':function(_0x70384,_0x3cdfaf){return _0x70384(_0x3cdfaf);},'kjcFu':function(_0x293fff,_0x1402e4){return _0x293fff!==_0x1402e4;},'TLgNR':function(_0x191d4e,_0x29670f){return _0x191d4e+_0x29670f;},'jdnCO':_0x224fd5(0xc9),'GIaJh':'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','VEEiQ':_0x224fd5(0x103),'LokSO':_0x224fd5(0xfd),'Hyhys':_0x224fd5(0xe4),'smQwJ':_0x224fd5(0x118),'hilXy':_0x224fd5(0x109),'VajtG':_0x224fd5(0x11d),'FdRrT':function(_0x2b0fa7,_0x3ebf47,_0x4ea3ef){return _0x2b0fa7(_0x3ebf47,_0x4ea3ef);},'xbirU':_0x224fd5(0xf6),'rgdAa':_0x224fd5(0xdb),'MIizr':function(_0x430a35,_0x1f60ff){return _0x430a35(_0x1f60ff);}};return new Promise(async(_0x51f298,_0x3a8e77)=>{const _0x46b904=_0x224fd5;try{if(_0x1d7ed3){let _0x1f0c6e=await _0x2ffbe5[_0x46b904(0xc2)](a0_0x11eb8b,_0x1d7ed3);if(_0x2ffbe5['kjcFu'](_0x1f0c6e[_0x46b904(0x119)],0xc8))throw await _0x1f0c6e['text']();_0x250382=await _0x1f0c6e[_0x46b904(0xc7)]();}let _0x1344c0=a0_0x39eb6c[_0x46b904(0x11c)](tmp,_0x2ffbe5['TLgNR'](+new Date(),_0x2ffbe5[_0x46b904(0xec)]));await a0_0x14b9d0[_0x46b904(0x108)][_0x46b904(0xd7)](_0x1344c0,_0x250382);let _0x57f6c0=spawn(_0x46b904(0xd0),['-y','-i',_0x1344c0,_0x46b904(0xcf),_0x2ffbe5[_0x46b904(0x115)],'-f',_0x2ffbe5[_0x46b904(0xf3)],'-']);_0x57f6c0['on'](_0x2ffbe5[_0x46b904(0xcc)],_0x3a8e77),_0x57f6c0['on'](_0x2ffbe5[_0x46b904(0xd6)],async()=>{const _0x508603=_0x46b904;await a0_0x14b9d0[_0x508603(0x108)][_0x508603(0x10e)](_0x1344c0);});let _0x202761=[];const [_0x50f184,..._0x5cb976]=[...module['exports']['support']['gm']?['gm']:module[_0x46b904(0x11e)][_0x46b904(0x118)]?[_0x2ffbe5[_0x46b904(0xd2)]]:[],'convert',_0x2ffbe5[_0x46b904(0x104)],_0x2ffbe5['VajtG']];let _0x4622aa=_0x2ffbe5['FdRrT'](spawn,_0x50f184,_0x5cb976);_0x4622aa['on'](_0x46b904(0xfd),_0x143125=>conn['reply'](m['chat'],util[_0x46b904(0xea)](_0x143125),m)),_0x4622aa[_0x46b904(0xe2)]['on'](_0x2ffbe5[_0x46b904(0xca)],_0x484bfd=>_0x202761[_0x46b904(0x106)](_0x484bfd)),_0x57f6c0['stdout'][_0x46b904(0xde)](_0x4622aa[_0x46b904(0xfb)]),_0x4622aa['on'](_0x2ffbe5[_0x46b904(0x105)],()=>{const _0x48ad21=_0x46b904;_0x2ffbe5[_0x48ad21(0xc2)](_0x51f298,Buffer[_0x48ad21(0xc0)](_0x202761));});}catch(_0x4c3c1c){_0x2ffbe5['MIizr'](_0x3a8e77,_0x4c3c1c);}});}async function canvas(_0x1c38f8,_0x2e74b6='png',_0x4cb097=0.92){const _0x1caf28=a0_0x2ba2e2,_0x26698d={'OhFTt':function(_0x5914af,_0x392cd0,_0x108886){return _0x5914af(_0x392cd0,_0x108886);},'AbOXA':_0x1caf28(0x11a),'sRKUB':function(_0x1c5e05,_0x291790){return _0x1c5e05(_0x291790);},'IGFZI':_0x1caf28(0xf2)};let _0x2441e6=await _0x26698d[_0x1caf28(0xe0)](a0_0x11eb8b,_0x26698d[_0x1caf28(0xff)]+_0x26698d[_0x1caf28(0xcb)](queryURL,{'type':_0x2e74b6,'quality':_0x4cb097}),{'method':_0x26698d['IGFZI'],'headers':{'Content-Type':'text/plain','Content-Length':_0x1c38f8[_0x1caf28(0xd9)]},'body':_0x1c38f8}),_0x412523=await _0x2441e6[_0x1caf28(0xc7)]();return _0x412523;}function queryURL(_0x3be86d){const _0x1d7384=a0_0x2ba2e2;return new URLSearchParams(Object[_0x1d7384(0x11f)](_0x3be86d));}async function sticker1(_0x3a4503,_0x1c699b){const _0x3dde06=a0_0x2ba2e2,_0xd19428={'JVAkK':function(_0xe7341c,_0x4d5540){return _0xe7341c(_0x4d5540);},'iCgQS':'image/jpeg','sGjnq':function(_0x232182,_0x15b724,_0x3f7833){return _0x232182(_0x15b724,_0x3f7833);}};_0x1c699b=_0x1c699b?_0x1c699b:await _0xd19428['JVAkK'](a0_0x5963ab,_0x3a4503);let {mime:_0xfcbc14}=_0x1c699b?{'mime':_0xd19428[_0x3dde06(0xfc)]}:await fileTypeFromBuffer(_0x3a4503),_0xf0fada=_0x3dde06(0xf7)+_0xfcbc14+_0x3dde06(0xc5)+_0x1c699b+_0x3dde06(0xee);return await _0xd19428[_0x3dde06(0xf1)](canvas,_0xf0fada,_0x3dde06(0xbc));}async function sticker3(_0xc43379,_0x3afbae,_0x424469,_0x34b259){const _0x2a294a=a0_0x2ba2e2,_0x39319d={'OKjZh':function(_0x48664b,_0x1f368a){return _0x48664b(_0x1f368a);},'vbzOS':function(_0x4ffc3e,_0x1c9319){return _0x4ffc3e+_0x1c9319;}};_0x3afbae=_0x3afbae?_0x3afbae:await _0x39319d[_0x2a294a(0xed)](a0_0x292f37,_0xc43379);let _0x24aa87=await _0x39319d['OKjZh'](a0_0x11eb8b,_0x39319d[_0x2a294a(0xb9)](_0x2a294a(0x10b),new URLSearchParams(Object[_0x2a294a(0x11f)]({'url':_0x3afbae,'packname':_0x424469,'author':_0x34b259}))));return await _0x24aa87[_0x2a294a(0xc7)]();}async function sticker4(_0xaf87dd,_0x3a91c9){const _0x12596=a0_0x2ba2e2,_0x24eb4a={'AzJOP':function(_0xa75be3,_0x38bdfb){return _0xa75be3(_0x38bdfb);},'FwGWL':function(_0x9a9a1c,_0x3dcb91){return _0x9a9a1c!==_0x3dcb91;},'DDRKC':function(_0x3322b1,_0x571307,_0x4c6faa,_0x536f6c,_0x671000){return _0x3322b1(_0x571307,_0x4c6faa,_0x536f6c,_0x671000);},'xEqUN':_0x12596(0xbc)};if(_0x3a91c9){let _0x58ea46=await _0x24eb4a['AzJOP'](a0_0x11eb8b,_0x3a91c9);if(_0x24eb4a[_0x12596(0xce)](_0x58ea46[_0x12596(0x119)],0xc8))throw await _0x58ea46['text']();_0xaf87dd=await _0x58ea46['buffer']();}return await _0x24eb4a[_0x12596(0xc8)](ffmpeg,_0xaf87dd,['-vf',_0x12596(0xe1)],_0x12596(0xd8),_0x24eb4a['xEqUN']);}async function sticker5(_0x3e0bfe,_0x5b63aa,_0x1febb4,_0x67ccca,_0x1cf3f6=[''],_0x212f40={}){const _0x17544d=a0_0x2ba2e2,_0xab9d00={'obTvE':_0x17544d(0xfe),'fiRgt':_0x17544d(0xe6)},{Sticker:_0x165b07}=await import(_0xab9d00['obTvE']),_0x3d732f={'type':_0xab9d00[_0x17544d(0xeb)],'pack':_0x1febb4,'author':_0x67ccca,'categories':_0x1cf3f6,..._0x212f40};return new _0x165b07(_0x3e0bfe?_0x3e0bfe:_0x5b63aa,_0x3d732f)[_0x17544d(0x11b)]();}function sticker6(_0x5aff3c,_0x271647){const _0x2014c2=a0_0x2ba2e2,_0x4921b9={'QLfPl':function(_0x1af779,_0x30b7bd){return _0x1af779(_0x30b7bd);},'denjh':function(_0xafc19,_0x168fcf){return _0xafc19!==_0x168fcf;},'VnbfO':function(_0x4446d8,_0x338fee){return _0x4446d8==_0x338fee;},'yyskJ':_0x2014c2(0xe5),'nBlLW':function(_0x727010,_0x39cdf6){return _0x727010+_0x39cdf6;},'eKFoi':_0x2014c2(0xda),'NfmES':_0x2014c2(0xfd),'iksyI':_0x2014c2(0x121),'YjsYe':_0x2014c2(0xbc)};return new Promise(async(_0xa1f64f,_0x37ed00)=>{const _0x2b12b1=_0x2014c2,_0x3a38a7={'QfsMt':function(_0x39390a,_0x12d3b){const _0x180daa=a0_0x49be;return _0x4921b9[_0x180daa(0xfa)](_0x39390a,_0x12d3b);}};if(_0x271647){let _0x57cd6f=await a0_0x11eb8b(_0x271647);if(_0x4921b9['denjh'](_0x57cd6f['status'],0xc8))throw await _0x57cd6f['text']();_0x5aff3c=await _0x57cd6f[_0x2b12b1(0xc7)]();}const _0x2ab5b5=await fileTypeFromBuffer(_0x5aff3c)||{'mime':'application/octet-stream','ext':_0x2b12b1(0xe5)};if(_0x4921b9[_0x2b12b1(0xd5)](_0x2ab5b5[_0x2b12b1(0x101)],_0x4921b9[_0x2b12b1(0xd1)]))_0x4921b9[_0x2b12b1(0xfa)](_0x37ed00,_0x5aff3c);const _0x6ee24a=a0_0x39eb6c['join'](__dirname,'../tmp/'+ +new Date()+'.'+_0x2ab5b5[_0x2b12b1(0x101)]),_0x3359d4=a0_0x39eb6c[_0x2b12b1(0x11c)](_0x4921b9['nBlLW'](_0x6ee24a,_0x4921b9['eKFoi']));await a0_0x14b9d0[_0x2b12b1(0x108)][_0x2b12b1(0xd7)](_0x6ee24a,_0x5aff3c);let _0xfa0f5=/video/i[_0x2b12b1(0xd4)](_0x2ab5b5[_0x2b12b1(0x114)])?_0x4921b9[_0x2b12b1(0xfa)](a0_0x37da7a,_0x6ee24a)['inputFormat'](_0x2ab5b5[_0x2b12b1(0x101)]):a0_0x37da7a(_0x6ee24a)[_0x2b12b1(0xe3)](_0x6ee24a);_0xfa0f5['on'](_0x4921b9[_0x2b12b1(0xdd)],function(_0x43cd2b){const _0x3bbbf9=_0x2b12b1;console[_0x3bbbf9(0xfd)](_0x43cd2b),a0_0x14b9d0['promises'][_0x3bbbf9(0x10e)](_0x6ee24a),_0x3a38a7['QfsMt'](_0x37ed00,_0x5aff3c);})['on'](_0x4921b9[_0x2b12b1(0x120)],async function(){const _0x4b8aa4=_0x2b12b1;a0_0x14b9d0['promises'][_0x4b8aa4(0x10e)](_0x6ee24a),_0xa1f64f(await a0_0x14b9d0[_0x4b8aa4(0x108)]['readFile'](_0x3359d4));})[_0x2b12b1(0x110)]([_0x2b12b1(0x10a),'libwebp',_0x2b12b1(0xcf),_0x2b12b1(0x111)])[_0x2b12b1(0xc4)](_0x4921b9[_0x2b12b1(0xe8)])[_0x2b12b1(0x10f)](_0x3359d4);});}async function addExif(_0x211a51,_0x297e01,_0x52221e,_0x75aff9=[''],_0x3891fc={}){const _0x5c8104=a0_0x2ba2e2,_0x3b0d2a={'YwsXC':_0x5c8104(0xbb)},_0xbebbf0=new a0_0x554b94['Image'](),_0x28f10b=a0_0x57c68c[_0x5c8104(0xbf)](0x20)[_0x5c8104(0xf5)](_0x3b0d2a[_0x5c8104(0xba)]),_0x17f975={'sticker-pack-id':_0x28f10b,'sticker-pack-name':_0x297e01,'sticker-pack-publisher':_0x52221e,'emojis':_0x75aff9,..._0x3891fc};let _0x26db7a=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x2892da=Buffer[_0x5c8104(0xbe)](JSON[_0x5c8104(0xe9)](_0x17f975),_0x5c8104(0x10d)),_0x17a82b=Buffer[_0x5c8104(0xc0)]([_0x26db7a,_0x2892da]);return _0x17a82b['writeUIntLE'](_0x2892da[_0x5c8104(0xd9)],0xe,0x4),await _0xbebbf0['load'](_0x211a51),_0xbebbf0[_0x5c8104(0xbd)]=_0x17a82b,await _0xbebbf0[_0x5c8104(0x10f)](null);}async function sticker(_0x43ef04,_0x5df807,..._0x2d4eaa){const _0x40fca3=a0_0x2ba2e2,_0xbb72d9={'OzgaA':function(_0x2fd939,_0x53ac06,_0x244727,..._0x32e4a6){return _0x2fd939(_0x53ac06,_0x244727,..._0x32e4a6);},'Kskzf':_0x40fca3(0xf9)};let _0x5f43cf,_0x17138f;for(let _0x44cd8b of[sticker3,global[_0x40fca3(0xdf)][_0x40fca3(0xd0)]&&sticker6,sticker5,global[_0x40fca3(0xdf)]['ffmpeg']&&global[_0x40fca3(0xdf)][_0x40fca3(0xef)]&&sticker4,global['support'][_0x40fca3(0xd0)]&&(global['support']['convert']||global[_0x40fca3(0xdf)][_0x40fca3(0x118)]||global[_0x40fca3(0xdf)]['gm'])&&sticker2,sticker1]['filter'](_0x290b76=>_0x290b76)){try{_0x17138f=await _0xbb72d9[_0x40fca3(0xf4)](_0x44cd8b,_0x43ef04,_0x5df807,..._0x2d4eaa);if(_0x17138f[_0x40fca3(0x10c)](_0xbb72d9[_0x40fca3(0xd3)]))try{return await addExif(_0x17138f,..._0x2d4eaa);}catch(_0x531334){return console[_0x40fca3(0xfd)](_0x531334),_0x17138f;}if(_0x17138f[_0x40fca3(0x10c)](_0x40fca3(0x117)))continue;throw _0x17138f[_0x40fca3(0xf5)]();}catch(_0x306781){_0x5f43cf=_0x306781;continue;}}return console['error'](_0x5f43cf),_0x5f43cf;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker1,sticker2,sticker3,sticker4,sticker5,sticker6,addExif,support};function a0_0x4c42(){const _0x5b3cba=['bin','default','4qytquT','YjsYe','stringify','format','fiRgt','jdnCO','OKjZh','\x27)))\x0ac.width\x20=\x20c.height\x20=\x20512\x0alet\x20max\x20=\x20Math.max(im.width,\x20im.height)\x0alet\x20w\x20=\x20512\x20*\x20im.width\x20/\x20max\x0alet\x20h\x20=\x20512\x20*\x20im.height\x20/\x20max\x0actx.drawImage(im,\x20256\x20-\x20w\x20/\x202,\x20256\x20-\x20h\x20/\x202,\x20w,\x20h)\x0a','ffmpegWebp','3279848WbsJoK','sGjnq','POST','VEEiQ','OzgaA','toString','data','let\x20im\x20=\x20await\x20loadImg(\x27data:','search','WEBP','QLfPl','stdin','iCgQS','error','wa-sticker-formatter','AbOXA','2327110BOLpzy','ext','1000738vvhkEV','png','hilXy','rgdAa','push','1153314QuFowq','promises','png:-','-vcodec','https://api.xteam.xyz/sticker/wm?','includes','utf8','unlink','save','addOutputOptions','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','../tmp','19369980gRiUwR','mime','GIaJh','1hLkKTJ','html','magick','status','https://nurutomo.herokuapp.com/api/canvas?','toBuffer','join','webp:-','exports','entries','iksyI','end','vbzOS','YwsXC','hex','webp','exif','from','randomBytes','concat','2684178AbvBTx','OcbDl','266760PZikpr','toFormat',';base64,\x27+(await\x20window.loadToDataURI(\x27','constructor','buffer','DDRKC','.jpeg','xbirU','sRKUB','LokSO','apply','FwGWL','-vf','ffmpeg','yyskJ','smQwJ','Kskzf','test','VnbfO','Hyhys','writeFile','jpeg','length','.webp','exit','(((.+)+)+)+$','NfmES','pipe','support','OhFTt','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','stdout','input','close'];a0_0x4c42=function(){return _0x5b3cba;};return a0_0x4c42();}