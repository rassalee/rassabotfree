const a0_0xf26fd4=a0_0x24fb;(function(_0x2e327b,_0x449ce4){const _0x495d37=a0_0x24fb,_0x484b46=_0x2e327b();while(!![]){try{const _0x3b9405=-parseInt(_0x495d37(0x1c2))/0x1*(-parseInt(_0x495d37(0x1df))/0x2)+-parseInt(_0x495d37(0x1ff))/0x3*(-parseInt(_0x495d37(0x209))/0x4)+-parseInt(_0x495d37(0x19d))/0x5+parseInt(_0x495d37(0x1f3))/0x6+-parseInt(_0x495d37(0x1e8))/0x7*(-parseInt(_0x495d37(0x1ee))/0x8)+-parseInt(_0x495d37(0x1ac))/0x9*(-parseInt(_0x495d37(0x1d4))/0xa)+-parseInt(_0x495d37(0x1ae))/0xb*(parseInt(_0x495d37(0x1c1))/0xc);if(_0x3b9405===_0x449ce4)break;else _0x484b46['push'](_0x484b46['shift']());}catch(_0x25eb45){_0x484b46['push'](_0x484b46['shift']());}}}(a0_0x5c91,0x22674));const a0_0x3d753a=(function(){let _0x1ed86e=!![];return function(_0x117e6e,_0x1b48bf){const _0x954ca8=_0x1ed86e?function(){const _0x3a7bbe=a0_0x24fb;if(_0x1b48bf){const _0x4046df=_0x1b48bf[_0x3a7bbe(0x1c6)](_0x117e6e,arguments);return _0x1b48bf=null,_0x4046df;}}:function(){};return _0x1ed86e=![],_0x954ca8;};}()),a0_0x5036d8=a0_0x3d753a(this,function(){const _0x5ea5ba=a0_0x24fb,_0x352143={'FmWEu':_0x5ea5ba(0x1c0)};return a0_0x5036d8[_0x5ea5ba(0x1fa)]()[_0x5ea5ba(0x1a5)](_0x352143['FmWEu'])['toString']()[_0x5ea5ba(0x1ea)](a0_0x5036d8)[_0x5ea5ba(0x1a5)](_0x5ea5ba(0x1c0));});a0_0x5036d8();import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x22f4b4 from'fs';import*as a0_0x534c77 from'path';import*as a0_0x281498 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x2c0458 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x391477 from'./uploadFile.js';import a0_0x3ad426 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x1ef238 from'node-webpmux';import a0_0x48f447 from'node-fetch';function a0_0x5c91(){const _0x2851ab=['unlink','vsckg','exif','BfjkS','fXUmQ','magick','xcBeO','2230nRvUEA','filter','includes','WEBP','join','SJJxE','libwebp','concat','webp:-','bin','.webp','56786BbTRmt','fXMWU','end','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','kmQnT','IEhLO','exit','text','image/jpeg','63PpsmpD','ffmpeg','constructor','utf8','readFile','PUgVQ','166592HUfmwc','mime','webp','application/octet-stream','close','294264OuqDJw','NTxtd','POST','addOutputOptions','miqCO','-vf','writeUIntLE','toString','stdout','text/plain','ZYntH','hex','6zvLjPB','ext','NTedU','eDoMv','randomBytes','entries','html','VMGLg','WMTRt','promises','165812ppQBhK','QPDpr','support','error','JUBDM','stringify','280185FYNGBa','status','chat','uatGK','save','exports','format','JgCAD','search','avImj','stdin','ffmpegWebp','-vcodec','../tmp','let\x20im\x20=\x20await\x20loadImg(\x27data:','9981QpGDor','kXqRx','11YkPIqs','buffer','hFrMD','Image','kIGQi','\x27)))\x0ac.width\x20=\x20c.height\x20=\x20512\x0alet\x20max\x20=\x20Math.max(im.width,\x20im.height)\x0alet\x20w\x20=\x20512\x20*\x20im.width\x20/\x20max\x0alet\x20h\x20=\x20512\x20*\x20im.height\x20/\x20max\x0actx.drawImage(im,\x20256\x20-\x20w\x20/\x202,\x20256\x20-\x20h\x20/\x202,\x20w,\x20h)\x0a','data','CXwZg','iYAMs','FCCmR','SXwDz','convert','KGfOW','pipe','jpeg','fkgrm','https://nurutomo.herokuapp.com/api/canvas?','.jpeg','(((.+)+)+)+$','4777356fcgQis','1gWTIUP','dEZQm','tKNJR','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','apply','length','writeFile','input','jGkeS','from','heYIv'];a0_0x5c91=function(){return _0x2851ab;};return a0_0x5c91();}const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x534c77[a0_0xf26fd4(0x1d8)](__dirname,a0_0xf26fd4(0x1aa));function sticker2(_0x506a70,_0x453fcd){const _0x42853a=a0_0xf26fd4,_0x205e1d={'JgCAD':function(_0x29cd05,_0x3fc5a7){return _0x29cd05(_0x3fc5a7);},'YaENH':function(_0x1c4831,_0x27d1db){return _0x1c4831+_0x27d1db;},'jGkeS':_0x42853a(0x1bf),'kmQnT':function(_0x383c1c,_0x23fcff,_0x523c8a){return _0x383c1c(_0x23fcff,_0x523c8a);},'GOMtz':_0x42853a(0x1e9),'dEZQm':_0x42853a(0x1e2),'vsckg':'png','kXqRx':'error','ggWVR':_0x42853a(0x1d2),'SJJxE':'convert','QPDpr':'png:-','iQHLL':_0x42853a(0x1dc)};return new Promise(async(_0x1e96c1,_0x599710)=>{const _0x301296=_0x42853a;try{if(_0x453fcd){let _0x249594=await a0_0x48f447(_0x453fcd);if(_0x249594[_0x301296(0x19e)]!==0xc8)throw await _0x249594['text']();_0x506a70=await _0x249594[_0x301296(0x1af)]();}let _0x1480df=a0_0x534c77['join'](tmp,_0x205e1d['YaENH'](+new Date(),_0x205e1d[_0x301296(0x1ca)]));await a0_0x22f4b4[_0x301296(0x208)]['writeFile'](_0x1480df,_0x506a70);let _0x17d220=_0x205e1d[_0x301296(0x1e3)](spawn,_0x205e1d['GOMtz'],['-y','-i',_0x1480df,_0x301296(0x1f8),_0x205e1d[_0x301296(0x1c3)],'-f',_0x205e1d[_0x301296(0x1ce)],'-']);_0x17d220['on'](_0x205e1d[_0x301296(0x1ad)],_0x599710),_0x17d220['on'](_0x301296(0x1f2),async()=>{const _0xfe96e=_0x301296;await a0_0x22f4b4[_0xfe96e(0x208)][_0xfe96e(0x1cd)](_0x1480df);});let _0x2e2553=[];const [_0x4f0e16,..._0x1ca1b1]=[...module['exports'][_0x301296(0x20b)]['gm']?['gm']:module[_0x301296(0x1a2)][_0x301296(0x1d2)]?[_0x205e1d['ggWVR']]:[],_0x205e1d[_0x301296(0x1d9)],_0x205e1d[_0x301296(0x20a)],_0x205e1d['iQHLL']];let _0x367949=spawn(_0x4f0e16,_0x1ca1b1);_0x367949['on'](_0x205e1d[_0x301296(0x1ad)],_0x30ad98=>conn['reply'](m[_0x301296(0x19f)],util[_0x301296(0x1a3)](_0x30ad98),m)),_0x367949['stdout']['on'](_0x301296(0x1b4),_0x116570=>_0x2e2553['push'](_0x116570)),_0x17d220[_0x301296(0x1fb)][_0x301296(0x1bb)](_0x367949[_0x301296(0x1a7)]),_0x367949['on'](_0x301296(0x1e5),()=>{const _0x1d45d2=_0x301296;_0x205e1d[_0x1d45d2(0x1a4)](_0x1e96c1,Buffer[_0x1d45d2(0x1db)](_0x2e2553));});}catch(_0x48876b){_0x599710(_0x48876b);}});}async function canvas(_0x50e1cd,_0x18328a='png',_0x388dc7=0.92){const _0x194e24=a0_0xf26fd4,_0x52b672={'ctafe':function(_0x5e3b67,_0x409f74,_0x476ce9){return _0x5e3b67(_0x409f74,_0x476ce9);},'NTedU':function(_0x4a603d,_0x2a1955){return _0x4a603d+_0x2a1955;},'fXMWU':_0x194e24(0x1be),'SXwDz':function(_0x45f2a4,_0x31c0c5){return _0x45f2a4(_0x31c0c5);},'CXwZg':_0x194e24(0x1f5)};let _0xef3fb4=await _0x52b672['ctafe'](a0_0x48f447,_0x52b672[_0x194e24(0x201)](_0x52b672[_0x194e24(0x1e0)],_0x52b672[_0x194e24(0x1b8)](queryURL,{'type':_0x18328a,'quality':_0x388dc7})),{'method':_0x52b672[_0x194e24(0x1b5)],'headers':{'Content-Type':_0x194e24(0x1fc),'Content-Length':_0x50e1cd[_0x194e24(0x1c7)]},'body':_0x50e1cd}),_0x5230b2=await _0xef3fb4[_0x194e24(0x1af)]();return _0x5230b2;}function queryURL(_0x24dda8){const _0x29b844=a0_0xf26fd4;return new URLSearchParams(Object[_0x29b844(0x204)](_0x24dda8));}async function sticker1(_0x343b83,_0x5e5a70){const _0x549c31=a0_0xf26fd4,_0x75a24e={'djsJM':_0x549c31(0x1e7),'PFZbH':function(_0x30698,_0x57d9c5){return _0x30698(_0x57d9c5);},'BJmlY':function(_0x447b29,_0x27c12a,_0x5550c3){return _0x447b29(_0x27c12a,_0x5550c3);}};_0x5e5a70=_0x5e5a70?_0x5e5a70:await a0_0x3ad426(_0x343b83);let {mime:_0x3f9e35}=_0x5e5a70?{'mime':_0x75a24e['djsJM']}:await _0x75a24e['PFZbH'](fileTypeFromBuffer,_0x343b83),_0x3e26c5=_0x549c31(0x1ab)+_0x3f9e35+';base64,\x27+(await\x20window.loadToDataURI(\x27'+_0x5e5a70+_0x549c31(0x1b3);return await _0x75a24e['BJmlY'](canvas,_0x3e26c5,'webp');}async function sticker3(_0x1d5283,_0x5c8d52,_0x2ea364,_0x5b9dc2){const _0x1ae817=a0_0xf26fd4,_0x27cb63={'BfjkS':function(_0x4c57c2,_0x15cb13){return _0x4c57c2(_0x15cb13);},'avImj':function(_0x11d070,_0x3a5d09){return _0x11d070+_0x3a5d09;}};_0x5c8d52=_0x5c8d52?_0x5c8d52:await _0x27cb63[_0x1ae817(0x1d0)](a0_0x391477,_0x1d5283);let _0x2a32f8=await _0x27cb63[_0x1ae817(0x1d0)](a0_0x48f447,_0x27cb63[_0x1ae817(0x1a6)]('https://api.xteam.xyz/sticker/wm?',new URLSearchParams(Object[_0x1ae817(0x204)]({'url':_0x5c8d52,'packname':_0x2ea364,'author':_0x5b9dc2}))));return await _0x2a32f8['buffer']();}async function sticker4(_0x4c8d88,_0x18805a){const _0xc4fb66=a0_0xf26fd4,_0x479145={'UbVGl':function(_0x38b23b,_0x40c3a7){return _0x38b23b(_0x40c3a7);},'PUgVQ':function(_0x2e75a4,_0x354645){return _0x2e75a4!==_0x354645;},'ZYntH':function(_0x3999fb,_0x2bc662,_0x1ba6e2,_0x24e694,_0x51a665){return _0x3999fb(_0x2bc662,_0x1ba6e2,_0x24e694,_0x51a665);},'FCCmR':_0xc4fb66(0x1f8),'ldfCg':_0xc4fb66(0x1e2),'heYIv':_0xc4fb66(0x1bc),'NTxtd':'webp'};if(_0x18805a){let _0xf9313f=await _0x479145['UbVGl'](a0_0x48f447,_0x18805a);if(_0x479145[_0xc4fb66(0x1ed)](_0xf9313f[_0xc4fb66(0x19e)],0xc8))throw await _0xf9313f[_0xc4fb66(0x1e6)]();_0x4c8d88=await _0xf9313f[_0xc4fb66(0x1af)]();}return await _0x479145[_0xc4fb66(0x1fd)](ffmpeg,_0x4c8d88,[_0x479145[_0xc4fb66(0x1b7)],_0x479145['ldfCg']],_0x479145[_0xc4fb66(0x1cc)],_0x479145[_0xc4fb66(0x1f4)]);}async function sticker5(_0x50bb58,_0x1b0410,_0x2117d2,_0x57abeb,_0x338e74=[''],_0x21cbb2={}){const _0x286083=a0_0xf26fd4,_0x506d7d={'IEhLO':'default'},{Sticker:_0x2cb674}=await import('wa-sticker-formatter'),_0x5d89ea={'type':_0x506d7d[_0x286083(0x1e4)],'pack':_0x2117d2,'author':_0x57abeb,'categories':_0x338e74,..._0x21cbb2};return new _0x2cb674(_0x50bb58?_0x50bb58:_0x1b0410,_0x5d89ea)['toBuffer']();}function sticker6(_0x27b006,_0x12d6aa){const _0x290a6d=a0_0xf26fd4,_0x4ae8b7={'hFrMD':function(_0x2d2330,_0xca25fb){return _0x2d2330(_0xca25fb);},'JUBDM':function(_0x34bc8e,_0x3d547e){return _0x34bc8e(_0x3d547e);},'tKNJR':function(_0x127711,_0x542799){return _0x127711!==_0x542799;},'GavhS':function(_0x20b564,_0x13301a){return _0x20b564(_0x13301a);},'fXUmQ':_0x290a6d(0x1f1),'KGfOW':_0x290a6d(0x1dd),'nQYdn':function(_0xa65f70,_0xaba96d){return _0xa65f70==_0xaba96d;},'fkgrm':function(_0x240c48,_0x18a6da){return _0x240c48(_0x18a6da);},'VMGLg':function(_0x3c0220,_0x336575){return _0x3c0220+_0x336575;},'eDoMv':_0x290a6d(0x20c),'WMTRt':_0x290a6d(0x1e1),'miqCO':_0x290a6d(0x1f0)};return new Promise(async(_0xd8f615,_0x178518)=>{const _0x5e72e0=_0x290a6d,_0x11cc39={'xcBeO':function(_0x43c7ea,_0x259758){const _0x113860=a0_0x24fb;return _0x4ae8b7[_0x113860(0x20d)](_0x43c7ea,_0x259758);}};if(_0x12d6aa){let _0x571008=await _0x4ae8b7[_0x5e72e0(0x20d)](a0_0x48f447,_0x12d6aa);if(_0x4ae8b7[_0x5e72e0(0x1c4)](_0x571008['status'],0xc8))throw await _0x571008[_0x5e72e0(0x1e6)]();_0x27b006=await _0x571008['buffer']();}const _0x438d81=await _0x4ae8b7['GavhS'](fileTypeFromBuffer,_0x27b006)||{'mime':_0x4ae8b7[_0x5e72e0(0x1d1)],'ext':_0x4ae8b7['KGfOW']};if(_0x4ae8b7['nQYdn'](_0x438d81[_0x5e72e0(0x200)],_0x4ae8b7[_0x5e72e0(0x1ba)]))_0x4ae8b7[_0x5e72e0(0x1bd)](_0x178518,_0x27b006);const _0x460eea=a0_0x534c77[_0x5e72e0(0x1d8)](__dirname,'../tmp/'+ +new Date()+'.'+_0x438d81[_0x5e72e0(0x200)]),_0x543dbb=a0_0x534c77[_0x5e72e0(0x1d8)](_0x4ae8b7[_0x5e72e0(0x206)](_0x460eea,_0x5e72e0(0x1de)));await a0_0x22f4b4[_0x5e72e0(0x208)][_0x5e72e0(0x1c8)](_0x460eea,_0x27b006);let _0x34dc00=/video/i['test'](_0x438d81[_0x5e72e0(0x1ef)])?_0x4ae8b7[_0x5e72e0(0x1b0)](a0_0x2c0458,_0x460eea)['inputFormat'](_0x438d81[_0x5e72e0(0x200)]):a0_0x2c0458(_0x460eea)[_0x5e72e0(0x1c9)](_0x460eea);_0x34dc00['on'](_0x4ae8b7[_0x5e72e0(0x202)],function(_0x9d50f3){const _0x76ccab=_0x5e72e0;console['error'](_0x9d50f3),a0_0x22f4b4[_0x76ccab(0x208)][_0x76ccab(0x1cd)](_0x460eea),_0x11cc39[_0x76ccab(0x1d3)](_0x178518,_0x27b006);})['on'](_0x4ae8b7[_0x5e72e0(0x207)],async function(){const _0x3c93eb=_0x5e72e0;a0_0x22f4b4['promises'][_0x3c93eb(0x1cd)](_0x460eea),_0x4ae8b7[_0x3c93eb(0x1b0)](_0xd8f615,await a0_0x22f4b4[_0x3c93eb(0x208)][_0x3c93eb(0x1ec)](_0x543dbb));})[_0x5e72e0(0x1f6)]([_0x5e72e0(0x1a9),_0x5e72e0(0x1da),_0x5e72e0(0x1f8),_0x5e72e0(0x1c5)])['toFormat'](_0x4ae8b7[_0x5e72e0(0x1f7)])[_0x5e72e0(0x1a1)](_0x543dbb);});}function a0_0x24fb(_0x2de992,_0x226b75){const _0x414bb7=a0_0x5c91();return a0_0x24fb=function(_0x5036d8,_0x3d753a){_0x5036d8=_0x5036d8-0x19d;let _0x5c916f=_0x414bb7[_0x5036d8];return _0x5c916f;},a0_0x24fb(_0x2de992,_0x226b75);}async function addExif(_0xc6ebba,_0x20b60c,_0x558c98,_0x29a42b=[''],_0xddd712={}){const _0x34e681=a0_0xf26fd4,_0x290045={'uatGK':_0x34e681(0x1fe),'iYAMs':_0x34e681(0x1eb)},_0x200019=new a0_0x1ef238[(_0x34e681(0x1b1))](),_0x571168=a0_0x281498[_0x34e681(0x203)](0x20)['toString'](_0x290045[_0x34e681(0x1a0)]),_0x582ca8={'sticker-pack-id':_0x571168,'sticker-pack-name':_0x20b60c,'sticker-pack-publisher':_0x558c98,'emojis':_0x29a42b,..._0xddd712};let _0x5e1816=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x46d465=Buffer[_0x34e681(0x1cb)](JSON[_0x34e681(0x20e)](_0x582ca8),_0x290045[_0x34e681(0x1b6)]),_0x17ba26=Buffer[_0x34e681(0x1db)]([_0x5e1816,_0x46d465]);return _0x17ba26[_0x34e681(0x1f9)](_0x46d465['length'],0xe,0x4),await _0x200019['load'](_0xc6ebba),_0x200019[_0x34e681(0x1cf)]=_0x17ba26,await _0x200019['save'](null);}async function sticker(_0x4943c7,_0x59707a,..._0x2a635f){const _0x33b439=a0_0xf26fd4,_0x1aee3d={'xPZni':function(_0x5d5cfb,_0x1ea351,_0x4c372d,..._0x25b0b9){return _0x5d5cfb(_0x1ea351,_0x4c372d,..._0x25b0b9);},'QEKxP':_0x33b439(0x1d7),'ksZRd':function(_0x4cc688,_0x2ad695,..._0x1afee3){return _0x4cc688(_0x2ad695,..._0x1afee3);},'kIGQi':_0x33b439(0x205)};let _0x2eafef,_0x176520;for(let _0x314c4f of[sticker3,global[_0x33b439(0x20b)][_0x33b439(0x1e9)]&&sticker6,sticker5,global[_0x33b439(0x20b)][_0x33b439(0x1e9)]&&global[_0x33b439(0x20b)][_0x33b439(0x1a8)]&&sticker4,global[_0x33b439(0x20b)][_0x33b439(0x1e9)]&&(global[_0x33b439(0x20b)][_0x33b439(0x1b9)]||global[_0x33b439(0x20b)][_0x33b439(0x1d2)]||global[_0x33b439(0x20b)]['gm'])&&sticker2,sticker1][_0x33b439(0x1d5)](_0xfcc37c=>_0xfcc37c)){try{_0x176520=await _0x1aee3d['xPZni'](_0x314c4f,_0x4943c7,_0x59707a,..._0x2a635f);if(_0x176520[_0x33b439(0x1d6)](_0x1aee3d['QEKxP']))try{return await _0x1aee3d['ksZRd'](addExif,_0x176520,..._0x2a635f);}catch(_0x423cc3){return console[_0x33b439(0x20c)](_0x423cc3),_0x176520;}if(_0x176520['includes'](_0x1aee3d[_0x33b439(0x1b2)]))continue;throw _0x176520[_0x33b439(0x1fa)]();}catch(_0x2f50dd){_0x2eafef=_0x2f50dd;continue;}}return console[_0x33b439(0x20c)](_0x2eafef),_0x2eafef;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker1,sticker2,sticker3,sticker4,sticker5,sticker6,addExif,support};