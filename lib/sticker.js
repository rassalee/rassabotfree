function a0_0x55ad(_0x4c8c08,_0x1e118c){const _0x372e40=a0_0x366c();return a0_0x55ad=function(_0x484b61,_0x57694b){_0x484b61=_0x484b61-0x130;let _0x366c54=_0x372e40[_0x484b61];return _0x366c54;},a0_0x55ad(_0x4c8c08,_0x1e118c);}const a0_0x50c546=a0_0x55ad;(function(_0xdb550b,_0x628c68){const _0x31f5cb=a0_0x55ad,_0x4eb840=_0xdb550b();while(!![]){try{const _0x482a8c=-parseInt(_0x31f5cb(0x13f))/0x1+-parseInt(_0x31f5cb(0x136))/0x2*(-parseInt(_0x31f5cb(0x133))/0x3)+-parseInt(_0x31f5cb(0x186))/0x4*(parseInt(_0x31f5cb(0x17f))/0x5)+parseInt(_0x31f5cb(0x193))/0x6+parseInt(_0x31f5cb(0x14b))/0x7+-parseInt(_0x31f5cb(0x130))/0x8+parseInt(_0x31f5cb(0x1a1))/0x9;if(_0x482a8c===_0x628c68)break;else _0x4eb840['push'](_0x4eb840['shift']());}catch(_0x410f2c){_0x4eb840['push'](_0x4eb840['shift']());}}}(a0_0x366c,0xad23b));const a0_0x57694b=(function(){let _0xfc7145=!![];return function(_0x5befbe,_0x32166c){const _0x3d12=_0xfc7145?function(){const _0x331680=a0_0x55ad;if(_0x32166c){const _0x362e98=_0x32166c[_0x331680(0x17a)](_0x5befbe,arguments);return _0x32166c=null,_0x362e98;}}:function(){};return _0xfc7145=![],_0x3d12;};}()),a0_0x484b61=a0_0x57694b(this,function(){const _0x4fa866=a0_0x55ad,_0x16fbed={'CmEbU':_0x4fa866(0x169)};return a0_0x484b61[_0x4fa866(0x139)]()['search'](_0x16fbed[_0x4fa866(0x149)])[_0x4fa866(0x139)]()[_0x4fa866(0x137)](a0_0x484b61)[_0x4fa866(0x164)](_0x16fbed[_0x4fa866(0x149)]);});a0_0x484b61();import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x59b166 from'fs';import*as a0_0xaec984 from'path';import*as a0_0x1fc890 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x3fe345 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x55281d from'./uploadFile.js';import a0_0x210cf0 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x3e929f from'node-webpmux';import a0_0x29024b from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x50c546(0x15e)])),tmp=a0_0xaec984[a0_0x50c546(0x166)](__dirname,a0_0x50c546(0x1a0));function sticker2(_0x52dc13,_0x3d882d){const _0x23234d=a0_0x50c546,_0x498117={'cMlRW':function(_0x54ff0a,_0x3131e0){return _0x54ff0a(_0x3131e0);},'pNWCk':function(_0x1fb283,_0xd434e4){return _0x1fb283(_0xd434e4);},'cttVU':function(_0x1013ca,_0x282dc4){return _0x1013ca+_0x282dc4;},'qwxaJ':_0x23234d(0x190),'uBOLc':function(_0x2a73bf,_0x40bb4a,_0x7b9bf7){return _0x2a73bf(_0x40bb4a,_0x7b9bf7);},'tmkjL':_0x23234d(0x155),'DoYSD':_0x23234d(0x156),'qeuma':_0x23234d(0x182),'OrFDh':_0x23234d(0x146),'YyJZh':_0x23234d(0x17d),'KFaRe':_0x23234d(0x150),'YoCPq':_0x23234d(0x158),'wuyvv':_0x23234d(0x179),'mLGxh':_0x23234d(0x19d),'dqAkE':_0x23234d(0x195),'lHlZu':'exit','YNdDl':function(_0x51e1f0,_0x3d6d95){return _0x51e1f0(_0x3d6d95);}};return new Promise(async(_0x4f6f10,_0x4e0553)=>{const _0x614e5c=_0x23234d;try{if(_0x3d882d){let _0x435c16=await _0x498117['pNWCk'](a0_0x29024b,_0x3d882d);if(_0x435c16[_0x614e5c(0x153)]!==0xc8)throw await _0x435c16[_0x614e5c(0x194)]();_0x52dc13=await _0x435c16[_0x614e5c(0x16d)]();}let _0x34a41f=a0_0xaec984[_0x614e5c(0x166)](tmp,_0x498117[_0x614e5c(0x17c)](+new Date(),_0x498117['qwxaJ']));await a0_0x59b166[_0x614e5c(0x135)][_0x614e5c(0x196)](_0x34a41f,_0x52dc13);let _0x153bea=_0x498117[_0x614e5c(0x192)](spawn,_0x498117[_0x614e5c(0x167)],['-y','-i',_0x34a41f,_0x498117[_0x614e5c(0x183)],_0x498117[_0x614e5c(0x151)],'-f',_0x498117['OrFDh'],'-']);_0x153bea['on'](_0x614e5c(0x19d),_0x4e0553),_0x153bea['on'](_0x498117[_0x614e5c(0x13c)],async()=>{const _0x4116c9=_0x614e5c;await a0_0x59b166[_0x4116c9(0x135)][_0x4116c9(0x148)](_0x34a41f);});let _0x470db6=[];const [_0x3b7bb6,..._0xad0cb2]=[...module[_0x614e5c(0x138)][_0x614e5c(0x16c)]['gm']?['gm']:module[_0x614e5c(0x138)][_0x614e5c(0x191)]?[_0x614e5c(0x191)]:[],_0x498117['KFaRe'],_0x498117['YoCPq'],_0x498117[_0x614e5c(0x199)]];let _0x5437cb=_0x498117['uBOLc'](spawn,_0x3b7bb6,_0xad0cb2);_0x5437cb['on'](_0x498117[_0x614e5c(0x15c)],_0x331066=>conn['reply'](m['chat'],util[_0x614e5c(0x170)](_0x331066),m)),_0x5437cb['stdout']['on'](_0x498117['dqAkE'],_0x4c606b=>_0x470db6[_0x614e5c(0x14e)](_0x4c606b)),_0x153bea[_0x614e5c(0x173)][_0x614e5c(0x14f)](_0x5437cb[_0x614e5c(0x176)]),_0x5437cb['on'](_0x498117[_0x614e5c(0x184)],()=>{const _0x1b8f2e=_0x614e5c;_0x498117[_0x1b8f2e(0x16e)](_0x4f6f10,Buffer[_0x1b8f2e(0x152)](_0x470db6));});}catch(_0x314c89){_0x498117[_0x614e5c(0x144)](_0x4e0553,_0x314c89);}});}function a0_0x366c(){const _0x1672bf=['uBOLc','4465818IzAxWR','text','data','writeFile','PxOgB','text/plain','wuyvv','eiVPj','libwebp','oCmwG','error','webp','https://nurutomo.herokuapp.com/api/canvas?','../tmp','13134609ZniSkK','9151616KpCURT','length','save','9mcuJJh','entries','promises','466xRAuSH','constructor','exports','toString','utf8','load','YyJZh','jpeg','Image','286001CLuDSW','application/octet-stream','test','MVzsP','exif','YNdDl','toBuffer','png','end','unlink','CmEbU','bWLFv','1115618BMyaRa','adgFI','input','push','pipe','convert','qeuma','concat','status','toFormat','ffmpeg','-vf','.webp','png:-','randomBytes','AipWw','stringify','mLGxh','WtQOr','url','lbhEF','DLQYM','includes','MrAog','filter','search','ZeYKi','join','tmkjL','rjwaB','(((.+)+)+)+$','FITco','CUZis','support','buffer','cMlRW','addOutputOptions','format','from','XAzcs','stdout','POST','sLCAV','stdin','hex','raeul','webp:-','apply','ext','cttVU','close','default','1255MXXRwN','CDwpU','inputFormat','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','DoYSD','lHlZu','neYTZ','3580qoKQzG','\x27)))\x0ac.width\x20=\x20c.height\x20=\x20512\x0alet\x20max\x20=\x20Math.max(im.width,\x20im.height)\x0alet\x20w\x20=\x20512\x20*\x20im.width\x20/\x20max\x0alet\x20h\x20=\x20512\x20*\x20im.height\x20/\x20max\x0actx.drawImage(im,\x20256\x20-\x20w\x20/\x202,\x20256\x20-\x20h\x20/\x202,\x20w,\x20h)\x0a','oRLjf','mime','Wcfle','-vcodec','writeUIntLE','nMNsn','sMzeq','PGwQM','.jpeg','magick'];a0_0x366c=function(){return _0x1672bf;};return a0_0x366c();}async function canvas(_0x1be85d,_0x271e72=a0_0x50c546(0x146),_0x1437d9=0.92){const _0x47812b=a0_0x50c546,_0x371c7c={'MrAog':function(_0xaf3832,_0x24589b){return _0xaf3832+_0x24589b;},'AipWw':function(_0x259ff4,_0x55cf0c){return _0x259ff4(_0x55cf0c);},'oRLjf':_0x47812b(0x174),'Ipbhy':_0x47812b(0x198)};let _0x5dc046=await a0_0x29024b(_0x371c7c[_0x47812b(0x162)](_0x47812b(0x19f),_0x371c7c[_0x47812b(0x15a)](queryURL,{'type':_0x271e72,'quality':_0x1437d9})),{'method':_0x371c7c[_0x47812b(0x188)],'headers':{'Content-Type':_0x371c7c['Ipbhy'],'Content-Length':_0x1be85d[_0x47812b(0x131)]},'body':_0x1be85d}),_0x4f9905=await _0x5dc046[_0x47812b(0x16d)]();return _0x4f9905;}function queryURL(_0x5bba06){const _0x275f6a=a0_0x50c546;return new URLSearchParams(Object[_0x275f6a(0x134)](_0x5bba06));}async function sticker1(_0x431ee0,_0x3d97f2){const _0x139684=a0_0x50c546,_0x27f03c={'WtQOr':function(_0x27b032,_0x3e69b2){return _0x27b032(_0x3e69b2);},'FITco':_0x139684(0x19e)};_0x3d97f2=_0x3d97f2?_0x3d97f2:await _0x27f03c[_0x139684(0x15d)](a0_0x210cf0,_0x431ee0);let {mime:_0x1c1453}=_0x3d97f2?{'mime':'image/jpeg'}:await fileTypeFromBuffer(_0x431ee0),_0x4bb7e5='let\x20im\x20=\x20await\x20loadImg(\x27data:'+_0x1c1453+';base64,\x27+(await\x20window.loadToDataURI(\x27'+_0x3d97f2+_0x139684(0x187);return await canvas(_0x4bb7e5,_0x27f03c[_0x139684(0x16a)]);}async function sticker3(_0x4af279,_0x56a4de,_0x581659,_0x28aa04){const _0x364f04=a0_0x50c546,_0x4f7a5e={'OEIpk':function(_0x28183a,_0x51d6e6){return _0x28183a(_0x51d6e6);},'Wcfle':function(_0x4dc863,_0x414a9e){return _0x4dc863+_0x414a9e;},'CUZis':'https://api.xteam.xyz/sticker/wm?'};_0x56a4de=_0x56a4de?_0x56a4de:await a0_0x55281d(_0x4af279);let _0x30bf81=await _0x4f7a5e['OEIpk'](a0_0x29024b,_0x4f7a5e[_0x364f04(0x18a)](_0x4f7a5e[_0x364f04(0x16b)],new URLSearchParams(Object['entries']({'url':_0x56a4de,'packname':_0x581659,'author':_0x28aa04}))));return await _0x30bf81[_0x364f04(0x16d)]();}async function sticker4(_0x242650,_0x317e10){const _0x34445c=a0_0x50c546,_0x1ca151={'wEexb':function(_0x39584c,_0x15049d){return _0x39584c(_0x15049d);},'sMzeq':function(_0xc71981,_0x626647,_0x4e955c,_0x20bc8c,_0xbe42fc){return _0xc71981(_0x626647,_0x4e955c,_0x20bc8c,_0xbe42fc);},'sLCAV':_0x34445c(0x156),'bWLFv':_0x34445c(0x13d),'MVzsP':_0x34445c(0x19e)};if(_0x317e10){let _0x433e70=await _0x1ca151['wEexb'](a0_0x29024b,_0x317e10);if(_0x433e70[_0x34445c(0x153)]!==0xc8)throw await _0x433e70[_0x34445c(0x194)]();_0x242650=await _0x433e70[_0x34445c(0x16d)]();}return await _0x1ca151[_0x34445c(0x18e)](ffmpeg,_0x242650,[_0x1ca151[_0x34445c(0x175)],_0x34445c(0x182)],_0x1ca151[_0x34445c(0x14a)],_0x1ca151[_0x34445c(0x142)]);}async function sticker5(_0x1ad29b,_0xe6cfd8,_0x5298b5,_0x384390,_0x347b26=[''],_0x26b5f1={}){const _0x23c380=a0_0x50c546,_0x8a79b9={'PxOgB':'wa-sticker-formatter'},{Sticker:_0x358dc6}=await import(_0x8a79b9[_0x23c380(0x197)]),_0x28aecc={'type':_0x23c380(0x17e),'pack':_0x5298b5,'author':_0x384390,'categories':_0x347b26,..._0x26b5f1};return new _0x358dc6(_0x1ad29b?_0x1ad29b:_0xe6cfd8,_0x28aecc)[_0x23c380(0x145)]();}function sticker6(_0x32c77b,_0x224b52){const _0x5c9639=a0_0x50c546,_0x3d10a7={'DLQYM':function(_0x433285,_0x1e1094){return _0x433285(_0x1e1094);},'oCmwG':function(_0x11dea3,_0x4aa514){return _0x11dea3(_0x4aa514);},'CDwpU':function(_0x2712db,_0x45c5c0){return _0x2712db(_0x45c5c0);},'HiKoL':_0x5c9639(0x140),'adgFI':'bin','eiVPj':function(_0x2a1a00,_0x292a89){return _0x2a1a00==_0x292a89;},'aIAKB':_0x5c9639(0x157),'lbhEF':function(_0x3e30f4,_0xeca30){return _0x3e30f4(_0xeca30);},'nMNsn':_0x5c9639(0x19d),'XAzcs':_0x5c9639(0x147),'raeul':'webp'};return new Promise(async(_0x586cc5,_0x346b58)=>{const _0x2a8b32=_0x5c9639,_0x362889={'fALgd':function(_0x25711d,_0xa0074f){const _0xc8c5f5=a0_0x55ad;return _0x3d10a7[_0xc8c5f5(0x160)](_0x25711d,_0xa0074f);},'PGwQM':function(_0x273570,_0x25b3c9){const _0x61675=a0_0x55ad;return _0x3d10a7[_0x61675(0x19c)](_0x273570,_0x25b3c9);}};if(_0x224b52){let _0x30bb6d=await a0_0x29024b(_0x224b52);if(_0x30bb6d[_0x2a8b32(0x153)]!==0xc8)throw await _0x30bb6d[_0x2a8b32(0x194)]();_0x32c77b=await _0x30bb6d[_0x2a8b32(0x16d)]();}const _0x3ec9e7=await _0x3d10a7['CDwpU'](fileTypeFromBuffer,_0x32c77b)||{'mime':_0x3d10a7['HiKoL'],'ext':_0x3d10a7['adgFI']};if(_0x3d10a7[_0x2a8b32(0x19a)](_0x3ec9e7[_0x2a8b32(0x17b)],_0x3d10a7[_0x2a8b32(0x14c)]))_0x346b58(_0x32c77b);const _0x5c10f1=a0_0xaec984['join'](__dirname,'../tmp/'+ +new Date()+'.'+_0x3ec9e7[_0x2a8b32(0x17b)]),_0x505fe7=a0_0xaec984['join'](_0x5c10f1+_0x3d10a7['aIAKB']);await a0_0x59b166[_0x2a8b32(0x135)][_0x2a8b32(0x196)](_0x5c10f1,_0x32c77b);let _0xe07d2c=/video/i[_0x2a8b32(0x141)](_0x3ec9e7[_0x2a8b32(0x189)])?_0x3d10a7[_0x2a8b32(0x180)](a0_0x3fe345,_0x5c10f1)[_0x2a8b32(0x181)](_0x3ec9e7['ext']):_0x3d10a7[_0x2a8b32(0x15f)](a0_0x3fe345,_0x5c10f1)[_0x2a8b32(0x14d)](_0x5c10f1);_0xe07d2c['on'](_0x3d10a7[_0x2a8b32(0x18d)],function(_0x91fdfe){const _0x4e0d68=_0x2a8b32;console['error'](_0x91fdfe),a0_0x59b166[_0x4e0d68(0x135)][_0x4e0d68(0x148)](_0x5c10f1),_0x362889['fALgd'](_0x346b58,_0x32c77b);})['on'](_0x3d10a7[_0x2a8b32(0x172)],async function(){const _0x50ed5f=_0x2a8b32;a0_0x59b166['promises']['unlink'](_0x5c10f1),_0x362889[_0x50ed5f(0x18f)](_0x586cc5,await a0_0x59b166['promises']['readFile'](_0x505fe7));})[_0x2a8b32(0x16f)]([_0x2a8b32(0x18b),_0x2a8b32(0x19b),_0x2a8b32(0x156),'scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse'])[_0x2a8b32(0x154)](_0x3d10a7[_0x2a8b32(0x178)])[_0x2a8b32(0x132)](_0x505fe7);});}async function addExif(_0x5c89db,_0xc6a2fd,_0x5a4217,_0x31c576=[''],_0x37d636={}){const _0x318763=a0_0x50c546,_0x5157ee={'neYTZ':_0x318763(0x177),'CweSq':_0x318763(0x13a)},_0x30dca7=new a0_0x3e929f[(_0x318763(0x13e))](),_0x201f57=a0_0x1fc890[_0x318763(0x159)](0x20)[_0x318763(0x139)](_0x5157ee[_0x318763(0x185)]),_0x3b610c={'sticker-pack-id':_0x201f57,'sticker-pack-name':_0xc6a2fd,'sticker-pack-publisher':_0x5a4217,'emojis':_0x31c576,..._0x37d636};let _0x208125=Buffer[_0x318763(0x171)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x40a2e4=Buffer[_0x318763(0x171)](JSON[_0x318763(0x15b)](_0x3b610c),_0x5157ee['CweSq']),_0x473f65=Buffer['concat']([_0x208125,_0x40a2e4]);return _0x473f65[_0x318763(0x18c)](_0x40a2e4[_0x318763(0x131)],0xe,0x4),await _0x30dca7[_0x318763(0x13b)](_0x5c89db),_0x30dca7[_0x318763(0x143)]=_0x473f65,await _0x30dca7['save'](null);}async function sticker(_0x452be2,_0x5874e9,..._0x429060){const _0x217af=a0_0x50c546,_0x10e40a={'xpyrt':'WEBP','rjwaB':function(_0x4bb809,_0x229869,..._0x5e3782){return _0x4bb809(_0x229869,..._0x5e3782);},'ZeYKi':'html'};let _0x406f97,_0x7ea34c;for(let _0x203005 of[sticker3,global[_0x217af(0x16c)][_0x217af(0x155)]&&sticker6,sticker5,global[_0x217af(0x16c)][_0x217af(0x155)]&&global[_0x217af(0x16c)]['ffmpegWebp']&&sticker4,global['support'][_0x217af(0x155)]&&(global[_0x217af(0x16c)][_0x217af(0x150)]||global[_0x217af(0x16c)][_0x217af(0x191)]||global[_0x217af(0x16c)]['gm'])&&sticker2,sticker1][_0x217af(0x163)](_0x28e152=>_0x28e152)){try{_0x7ea34c=await _0x203005(_0x452be2,_0x5874e9,..._0x429060);if(_0x7ea34c[_0x217af(0x161)](_0x10e40a['xpyrt']))try{return await _0x10e40a[_0x217af(0x168)](addExif,_0x7ea34c,..._0x429060);}catch(_0x3cf2d2){return console[_0x217af(0x19d)](_0x3cf2d2),_0x7ea34c;}if(_0x7ea34c['includes'](_0x10e40a[_0x217af(0x165)]))continue;throw _0x7ea34c[_0x217af(0x139)]();}catch(_0x3f8cce){_0x406f97=_0x3f8cce;continue;}}return console[_0x217af(0x19d)](_0x406f97),_0x406f97;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker1,sticker2,sticker3,sticker4,sticker5,sticker6,addExif,support};